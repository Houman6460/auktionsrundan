/* Overlay targets should be block to create a stable box for absolute positioning */
.tooltip-root [data-tip][data-tip-pos="overlay"] {
  display: block;
}
/* stylelint-disable at-rule-no-unknown */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Base typography */
:root {
  color-scheme: light;
}

/* Make each tooltip target a positioning context */
.tooltip-root [data-tip] {
  position: relative;
}

body {
  @apply bg-vintage-cream text-vintage-black font-sans antialiased;
}

/* Prevent horizontal scrolling caused by off-canvas effects on mobile */
html, body {
  max-width: 100%;
  overflow-x: hidden;
}

.container {
  @apply max-w-6xl;
}

.section-card {
  @apply bg-white/80 backdrop-blur shadow-sm rounded-lg border border-amber-900/10;
  transition: transform .18s ease, box-shadow .18s ease, background-color .18s ease;
}

/* Subtle lift on hover for pointer devices only */
@media (hover: hover) and (pointer: fine) {
  .section-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 24px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.06);
  }
}

/* Focus-visible ring for accessibility */
.section-card:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px rgba(253, 230, 138, 0.9), 0 10px 24px rgba(0,0,0,0.08);
}

/* Opt-in content-visibility helper for large lists */
.cv-auto {
  content-visibility: auto;
  contain-intrinsic-size: 300px 250px; /* fallback size to prevent layout jumps */
}

/* Respect users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  .section-card {
    transition: none !important;
  }
  .animate-spin {
    animation: none !important;
  }
}

.btn-primary {
  @apply inline-flex items-center gap-2 px-4 py-2 rounded-md bg-earth-dark text-white hover:bg-earth transition;
}

.btn-outline {
  @apply inline-flex items-center gap-2 px-4 py-2 rounded-md border border-earth-dark text-earth-dark hover:bg-earth-light/30 transition;
}

/* Admin tooltips based on [data-tip] (set by Admin.jsx). Works on hover and keyboard focus. */
.tooltip-root [data-tip] {
  position: relative;
}
.tooltip-root [data-tip]::after {
  content: attr(data-tip);
  position: absolute;
  left: 50%;
  bottom: calc(100% + 8px);
  transform: translateX(-50%);
  background: var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  color: var(--tooltip-fg, #ffffff);
  padding: 6px 8px;
  border-radius: 8px;
  font-size: 12px;
  line-height: 1.25;
  white-space: pre-wrap;
  max-width: 280px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.20);
  pointer-events: none;
  z-index: 9999;
  will-change: transform, top, left;
  display: none;
}
.tooltip-root [data-tip]::before {
  content: '';
  position: absolute;
  left: 50%;
  bottom: calc(100% + 2px);
  transform: translateX(-50%);
  width: 0; height: 0;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-top: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  pointer-events: none;
  z-index: 50;
  display: none;
}
.tooltip-root [data-tip]:hover::after,
.tooltip-root [data-tip]:focus::after,
.tooltip-root [data-tip]:hover::before,
.tooltip-root [data-tip]:focus::before {
  display: block;
}

/* Viewport-fixed positioning to avoid clipping in scroll containers */
.tooltip-root [data-tip][data-tip-fixed="1"]::after,
.tooltip-root [data-tip][data-tip-fixed="1"]::before {
  position: fixed;
  left: var(--tip-left);
  top: var(--tip-top);
}

/* Transforms for bubble based on active placement */
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="top"]::after { transform: translate(-50%, -100%); }
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="bottom"]::after { transform: translate(-50%, 0); }
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="right"]::after { transform: translate(0, -50%); }
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="left"]::after { transform: translate(-100%, -50%); }

/* Fixed overlay variant: cover the element using provided coordinates and width */
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="overlay"]::after {
  transform: none;
  width: var(--tip-width, auto);
  height: var(--tip-height, auto);
  display: flex;
  align-items: center;
}
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="overlay"]::before {
  display: none;
}

/* Arrow orientation and transforms for fixed position */
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="top"]::before {
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-top: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  transform: translate(-50%, 0);
}
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="bottom"]::before {
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-bottom: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  transform: translate(-50%, 0);
}
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="right"]::before {
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  border-left: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  transform: translate(0, -50%);
}
.tooltip-root [data-tip][data-tip-fixed="1"][data-tip-pos-active="left"]::before {
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  border-right: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  transform: translate(0, -50%);
}

/* Positional variants */
/* Default is top (above). Use data-tip-pos to override. */
.tooltip-root [data-tip][data-tip-pos="bottom"]::after {
  top: calc(100% + 8px);
  bottom: auto;
}
.tooltip-root [data-tip][data-tip-pos="bottom"]::before {
  top: calc(100% + 2px);
  bottom: auto;
  border-top: 0;
  border-bottom: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
}
.tooltip-root [data-tip][data-tip-pos="right"]::after {
  left: calc(100% + 10px);
  top: 50%;
  bottom: auto;
  transform: translateY(-50%);
}
.tooltip-root [data-tip][data-tip-pos="right"]::before {
  left: calc(100% + 2px);
  top: 50%;
  bottom: auto;
  transform: translateY(-50%);
  border-left: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  border-right: 0;
}
.tooltip-root [data-tip][data-tip-pos="left"]::after {
  right: calc(100% + 10px);
  left: auto;
  top: 50%;
  bottom: auto;
  transform: translateY(-50%);
}
.tooltip-root [data-tip][data-tip-pos="left"]::before {
  right: calc(100% + 2px);
  left: auto;
  top: 50%;
  bottom: auto;
  transform: translateY(-50%);
  border-right: 6px solid var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  border-left: 0;
}

/* Overlay variant (local mode): cover the element */
.tooltip-root [data-tip][data-tip-pos="overlay"]::after {
  left: 50%;
  top: auto;
  bottom: calc(100% + 8px);
  width: auto;
  max-width: min(360px, 90vw);
  transform: translateX(-50%);
  height: auto;
  display: block;
  white-space: normal;
  word-break: break-word;
  overflow-wrap: anywhere;
  line-height: 1.35;
  padding: 6px 10px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.10), 0 2px 6px rgba(0,0,0,0.08);
  pointer-events: none;
  z-index: 9999;
}
.tooltip-root [data-tip][data-tip-pos="overlay"]::before {
  display: none;
}

/* Disable entirely when tips are off */
.tooltip-root.tips-off [data-tip]::after,
.tooltip-root.tips-off [data-tip]::before {
  display: none !important;
}

/* Ensure fixed rules override positional variants */
.tooltip-root [data-tip][data-tip-fixed="1"]::after,
.tooltip-root [data-tip][data-tip-fixed="1"]::before {
  left: var(--tip-left) !important;
  top: var(--tip-top) !important;
  right: auto !important;
  bottom: auto !important;
}

/* Body-level portal bubble for overlay tooltips (escapes container clipping) */
.admin-tooltip-portal {
  position: fixed;
  left: 0;
  top: 0;
  background: var(--tooltip-bg, rgba(82, 65, 43, 0.96));
  color: var(--tooltip-fg, #ffffff);
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 12px;
  line-height: 1.35;
  white-space: normal;
  word-break: break-word;
  overflow-wrap: anywhere;
  max-width: min(360px, 90vw);
  box-shadow: 0 8px 30px rgba(0,0,0,0.10), 0 2px 6px rgba(0,0,0,0.08);
  pointer-events: none;
  z-index: 9999;
}

/* Tour spotlight: frames the target and dims surroundings using a giant spread shadow */
.tour-spotlight {
  position: fixed;
  left: 0; top: 0; width: 0; height: 0;
  border-radius: 10px;
  border: 2px solid rgba(255, 200, 80, 0.95);
  box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.45), 0 8px 30px rgba(0,0,0,0.25);
  pointer-events: none;
  z-index: 99998; /* under modal (z-[100000]) but above page */
  transition: left .18s ease, top .18s ease, width .18s ease, height .18s ease;
}

/* stylelint-enable at-rule-no-unknown */
